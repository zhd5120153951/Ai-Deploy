import{P as I}from"./index.d37c8696.js";import{E as N}from"./element-plus.ef27c94c.js";import{F as M,_ as E,a as K}from"./index.00854a6a.js";import{u as Q,d as X,b as Y}from"./index.b60a26c4.js";import{_ as j}from"./index.796a76b8.js";import{D as q}from"./vuedraggable.0ebeab5f.js";import{f as G}from"./@vueuse.07613b64.js";import{d as H,r as i,ab as J,e as S,w as O,E as P,n as W,ag as U,o as Z,c as x,X as n,aa as ee,P as p,a as s,$ as V,R as k,U as le,Q as ae,K as te,a0 as oe,Y as se,b7 as ie,b6 as ne}from"./@vue.a137a740.js";const re=H({components:{Popup:I,Draggable:q,FileItem:M,Material:E,Preview:K},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:t}){const g=i(),h=i(),_=i(""),w=i(!1),a=i([]),m=i([]),r=i(!0),c=i(-1),{disabled:y,limit:u,modelValue:C}=J(e),{getImageUrl:b,getimageUrl:o}=Q(),f=S(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),v=S(()=>e.limit-a.value.length>0),D=S(()=>r.value?u.value==-1?null:u.value-a.value.length:1),A=G(()=>{const l=m.value.map(d=>(e.excludeDomain,d.url));r.value?a.value=[...a.value,...l]:a.value.splice(c.value,1,l.shift()),$()},1e3,!1),F=l=>{var d;y.value||(l>=0?(r.value=!1,c.value=l):r.value=!0,(d=g.value)==null||d.open())},R=l=>{m.value=l},$=()=>{const l=u.value!=1?a.value:a.value[0]||"";t("update:modelValue",l),t("change",l),z()},L=l=>{a.value.splice(l,1),$()},T=l=>{_.value=l,w.value=!0},z=()=>{W(()=>{var l;e.hiddenUpload&&(a.value=[]),(l=h.value)==null||l.clearSelect()})};return O(C,l=>{a.value=Array.isArray(l)?l:l==""?[]:[l]},{immediate:!0}),P("limit",e.limit),P("hiddenUpload",e.hiddenUpload),{popupRef:g,materialRef:h,fileList:a,tipsText:f,handleConfirm:A,meterialLimit:D,showUpload:v,showPopup:F,selectChange:R,deleteImg:L,previewUrl:_,showPreview:w,handlePreview:T,handleClose:z,getImageUrl:b}}});const B=e=>(ie("data-v-bd8ab327"),e=e(),ne(),e),ue={class:"material-select"},de=["onClick"],pe={class:"operation-btns text-xs text-center"},me=B(()=>s("span",null,"\u4FEE\u6539",-1)),ce=["onClick"],fe=B(()=>s("span",null,"\u6DFB\u52A0",-1)),ve={class:"material-wrap"};function ge(e,t,g,h,_,w){const a=U("file-item"),m=j,r=U("draggable"),c=Y,y=E,u=N,C=I,b=U("preview");return Z(),x("div",ue,[n(C,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},ee({default:p(()=>[n(u,null,{default:p(()=>[s("div",ve,[n(y,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:p(()=>[s("div",{class:"material-select__trigger clearfix",onClick:t[2]||(t[2]=V(()=>{},["stop"]))},[n(r,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":t[0]||(t[0]=o=>e.fileList=o),animation:"300","item-key":"id"},{item:p(({element:o,index:f})=>[s("div",{class:k(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:v=>e.showPopup(f)},[n(m,{onClose:v=>e.deleteImg(f)},{default:p(()=>[n(a,{uri:e.excludeDomain?e.getImageUrl(o):o,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),s("div",pe,[me,le(" | "),s("span",{onClick:V(v=>e.handlePreview(o),["stop"])},"\u67E5\u770B",8,ce)])],10,de)]),_:1},8,["modelValue"]),ae(s("div",{class:k(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:t[1]||(t[1]=o=>e.showPopup(-1))},[te(e.$slots,"upload",{},()=>[s("div",{class:"upload-btn",style:oe({width:e.size,height:e.size})},[n(c,{size:25,name:"el-icon-Plus"}),fe],4)],!0)],2),[[se,e.showUpload]])])]),key:"0"}]),1032,["title","onConfirm","onClose"]),n(b,{modelValue:e.showPreview,"onUpdate:modelValue":t[3]||(t[3]=o=>e.showPreview=o),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const $e=X(re,[["render",ge],["__scopeId","data-v-bd8ab327"]]);export{$e as _};
